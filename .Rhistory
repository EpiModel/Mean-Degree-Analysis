theme_minimal(base_size = 10)
casl_plot <- casl_plot +
geom_hline(aes(yintercept = unique(md_casl_dos)),
linetype = "dotted",
data = md_df)
casl_plot <- casl_plot +
geom_hline(aes(yintercept = unique(md_casl_dos_ll)),
linetype = "dashed",
data = md_df)
casl_plot <- casl_plot +
geom_hline(aes(yintercept = unique(md_casl_dos_ul)),
linetype = "dashed",
data = md_df)
casl_plot <- casl_plot + scale_x_discrete(breaks = factor(
unique(md_df$month_num)),
labels = unique(md_df$month))
#require(gridExtra)
suppressMessages(grid.arrange(total_plot, main_plot, casl_plot, nrow=3))
} else {
total_plot_title <- paste("Total Partnerships")
main_plot_title <- paste("Main Partnerships")
casl_plot_title <- paste("Casual Partnerships")
total_plot <- ggplot(md_df,
aes(x=factor(month_num), y=md_total,
group=var_val, color=var_val),
theme(axis.text.x = month)) +
geom_line() +
geom_point()+
geom_errorbar(
aes(ymin=md_total_ll, ymax=md_total_ul),
width=.2,
position=position_dodge(0.05)) +
labs(title=total_plot_title,
x = "Month Offset", y = "Mean Degree") +
scale_color_discrete(name=cat,
labels=labels) +
ylim(c(0.5, 2))
total_plot <- total_plot +
geom_hline(data = md_df,
aes(yintercept = md_total_dos, col = var_val),
linetype = "dashed") +
theme_minimal(base_size = 10)
main_plot <- ggplot(md_df,
aes(x=factor(month_num), y=md_main,
group=var_val, color=var_val),
theme(axis.text.x = month)) +
geom_line() +
geom_point() +
geom_errorbar(
aes(ymin=md_main_ll, ymax=md_main_ul),
width=.2,
position=position_dodge(0.05)) +
labs(title=main_plot_title,
x = "Month Offset", y = "Mean Degree") +
theme_minimal(base_size = 10) +
theme(legend.position = "none") +
ylim(c(0.2, 0.6))
main_plot <- main_plot +
geom_hline(data = md_df,
aes(yintercept = md_main_dos, col = var_val),
linetype = "dashed")
casl_plot <- ggplot(md_df,
aes(x=factor(month_num), y=md_casl,
group=var_val, color=var_val),
theme(axis.text.x = month)) +
geom_line() +
geom_point()+
geom_errorbar(
aes(ymin=md_casl_ll, ymax=md_casl_ul),
width=.2,
position=position_dodge(0.05)) +
labs(title=casl_plot_title,
x = "Month Offset", y = "Mean Degree") +
theme_minimal(base_size = 10) +
theme(legend.position = "none") +
ylim(c(0.3, 2))
casl_plot <- casl_plot +
geom_hline(data = md_df,
aes(yintercept = md_casl_dos, col = var_val),
linetype = "dashed")
#require(gridExtra)
#require(cowplot)
legend <- get_legend(total_plot)
total_plot <- total_plot + theme(legend.position = "none")
grid.arrange(arrangeGrob(total_plot, main_plot, casl_plot), legend, ncol=2,
widths=c(5,1))
}
}
png('FigureX.png', width=2048, height=1536, res=300)
plot_md_comparisons(partners_bi2, "Partners",
c("5 or fewer partners",
"6 or more partners"))
dev.off()
png('FigureX.png', width=2048, height=1536, res=300)
plot_md_comparisons(partners_bi2, "Partners",
c("5 or fewer partners",
"6 or more partners"))
dev.off()
# Specify start and end months for offsets
# Note: Only single month steps are supported
start_month_offset <- 0
end_month_offset <- 12
month <- seq(start_month_offset, end_month_offset)
n_month <- paste(month, "M", sep="")
# Initalize data frames with appropriate row and column dimensions
ongoing.eval.m <- matrix(nrow = length(ARTnet.long$SUB_DATE),
ncol = end_month_offset - start_month_offset + 1)
ongoing.eval.df <- data.frame(ongoing.eval.m)
ongoing3.m <- matrix(nrow = length(ARTnet.long$SUB_DATE),
ncol = end_month_offset - start_month_offset + 1)
ongoing3.df <- data.frame(ongoing3.m)
ARTnet.long.adjusted <- ARTnet.long
ARTnet.wide.adjusted <- ARTnet.wide
mean.degree.main <- c()
mean.degree.casual <- c()
for (i in start_month_offset:end_month_offset) {
ongoing.eval <- paste("ongoing.evaluation.date.m",i,sep="")
names(ongoing.eval.df)[i - start_month_offset + 1] <- ongoing.eval
assign(ongoing.eval, ARTnet.long$SUB_DATE - round(i*30.44))
ongoing.eval.df[,i - start_month_offset + 1] <- get(ongoing.eval)
ongoing3 <- paste("ongoing3.m",i,sep="")
names(ongoing3.df)[i - start_month_offset + 1] <- ongoing3
assign(ongoing3, ifelse(is.na(ifelse(ARTnet.long.adjusted$start.date.2 <=
get(ongoing.eval) &
ARTnet.long.adjusted$end.date.2 >= get(ongoing.eval),
1, 0)), 0, ifelse(ARTnet.long.adjusted$start.date.2 <=
get(ongoing.eval) &
ARTnet.long.adjusted$end.date.2 >= get(ongoing.eval),
1, 0)))
ongoing3.df[,i - start_month_offset + 1] <- get(ongoing3)
ARTnet.long.adjusted <- cbind(ARTnet.long.adjusted,
ongoing.eval.df[i - start_month_offset + 1],
ongoing3.df[i - start_month_offset + 1])
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 1) %>%
group_by(AMIS_ID) %>%
summarise(deg.main.n.month = sum(get(paste("ongoing3.m",i,sep="")))) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
# #Additional filtering
# ARTnet.wide.adjusted <- ARTnet.wide.adjusted %>%
#   filter(age >= 16 & age <= 29) %>%
#   filter(city2 == "Chicago")
ARTnet.wide.adjusted$deg.main.n.month <- ifelse(is.na(
ARTnet.wide.adjusted$deg.main.n.month), 0,
ARTnet.wide.adjusted$deg.main.n.month)
mean.degree.main[i - start_month_offset + 1] <- mean(
ARTnet.wide.adjusted$deg.main.n.month)
deg.main.n.month.name <- paste("deg.main.n.month.m",i,sep="")
names(ARTnet.wide.adjusted)[names(ARTnet.wide.adjusted) ==
"deg.main.n.month"] <- deg.main.n.month.name
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 2) %>%
group_by(AMIS_ID) %>%
summarise(deg.casl.n.month = sum(get(paste("ongoing3.m",i,sep="")))) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted$deg.casl.n.month <- ifelse(is.na(
ARTnet.wide.adjusted$deg.casl.n.month), 0,
ARTnet.wide.adjusted$deg.casl.n.month)
mean.degree.casual[i - start_month_offset + 1] <- mean(
ARTnet.wide.adjusted$deg.casl.n.month)
deg.casl.n.month.name <- paste("deg.casl.n.month.m",i,sep="")
names(ARTnet.wide.adjusted)[names(ARTnet.wide.adjusted) ==
"deg.casl.n.month"] <- deg.casl.n.month.name
}
table(ARTnet.long.adjusted$ongoing3.m0, ARTnet.long.adjusted$ONGOING)
table(ARTnet.long.adjusted$ongoing3.m0, ARTnet.long.adjusted$ONGOING, useNA = "always")
table(ARTnet.long.adjusted$ongoing3.m0)
table(ARTnet.long.adjusted$ongoing3.m0, useNA = "always")
addmargins(table(ARTnet.long.adjusted$ongoing3.m0, ARTnet.long.adjusted$ONGOING, useNA = "always"))
table(ARTnet.wide.adjusted$n.main, ARTnet.wide.adjusted$n.casl)
table(ARTnet.wide.adjusted$n.main, ARTnet.wide.adjusted$n.casl, ARTnet.wide.adjusted$n.one)
install.packages("arsenal")
library(arsenal)
tab.ex <- table(ARTnet.wide.adjusted[, c("n.main", "n.casl", "n.one")], useNA = "ifany")
freqlist(tab.ex)
ex <- freqlist(tab.ex)
ex
str(ex)
as.data.frame(ex)
ex <- as.data.frame(ex)
write.csv(ex, file= "cum_table")
write.csv(ex, file= "cum_table.csv")
png('SF6.png', width=2048, height=1536, res=300)
plot_md_comparisons(partners_bi2, "Total Partners",
c("5 or fewer",
"6 or more"))
dev.off()
partners_bi2 <- n_month_offset(0,12,'partners_bi2')
partners_bi2 <- partners_bi2 %>% filter(!is.na(var_val))
png('SF6.png', width=2048, height=1536, res=300)
plot_md_comparisons(partners_bi2, "Total Partners",
c("5 or fewer",
"6 or more"))
dev.off()
png('SF7.png', width=2048, height=1536, res=300)
ggplot(ARTnet.wide.adjusted, aes(x = main.avgduration.yr, y = main.slope)) +
theme_classic() +
geom_point(alpha = 0.1, size = 3) +
xlab("Mean Age of Main Relationships (Years)") +
ylab("Change in Degree of Main Relationships at 12- and 0-Month Offsets")
dev.off()
# Create variables for number of main, casual, and one-time partners reported
ARTnet.wide.adjusted <-
ARTnet.long.adjusted %>%
filter(ptype == 1) %>%
group_by(AMIS_ID) %>%
summarise(n.main = n()) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted <-
ARTnet.long.adjusted %>%
filter(ptype == 2) %>%
group_by(AMIS_ID) %>%
summarise(n.casl = n()) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted <-
ARTnet.long.adjusted %>%
filter(ptype == 3) %>%
group_by(AMIS_ID) %>%
summarise(n.one = n()) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
# Replace NA's with 0
ARTnet.wide.adjusted$n.main[is.na(ARTnet.wide.adjusted$n.main)] <- 0
ARTnet.wide.adjusted$n.casl[is.na(ARTnet.wide.adjusted$n.casl)] <- 0
ARTnet.wide.adjusted$n.one[is.na(ARTnet.wide.adjusted$n.one)] <- 0
# Create variable for total partners reported
ARTnet.wide.adjusted$n.all <- ARTnet.wide.adjusted$n.main + ARTnet.wide.adjusted$n.casl + ARTnet.wide.adjusted$n.one
# Check data
table(ARTnet.wide.adjusted$n.main, useNA = "always")
table(ARTnet.wide.adjusted$n.casl, useNA = "always")
table(ARTnet.wide.adjusted$n.one, useNA = "always")
table(ARTnet.wide.adjusted$n.all, useNA = "always")
# Create dichotomous variable for participants reporting 5 or fewer partners
# overall compared with participants reporting more than 5 partners in the
# past year overall
ARTnet.wide.adjusted$partners_bi <- ifelse(ARTnet.wide.adjusted$M_MP12OANUM2 > 5, 1, 0)
# Crosstab of the dichotomous
addmargins(table(ARTnet.wide.adjusted$partners_bi, ARTnet.wide.adjusted$n.all, useNA = "always"))
# Create a new dichotomous variable for participants reporting 5 or fewer partners
# regardless of they have 5 or more total partners
# 0 = 5 or fewer partners
# 1 = 6+ partners
ARTnet.wide.adjusted$partners_bi2 <-
ifelse(ARTnet.wide.adjusted$n.all < 5 & ARTnet.wide.adjusted$partners_bi == 1, 0,
ifelse(ARTnet.wide.adjusted$partners_bi == 1, 1, 0))
# Check variable
table(ARTnet.wide.adjusted$partners_bi2, ARTnet.wide.adjusted$partners_bi)
# Slope by new variable
ARTnet.wide.adjusted %>%
group_by(partners_bi2) %>%
summarize(mean.slope.m = mean(main.slope),
mean.slope.c = mean(casl.slope))
# Create a new variable for levels of reported male partners
ARTnet.wide.adjusted$total_part <-
ifelse(ARTnet.wide.adjusted$n.all < 5, ARTnet.wide.adjusted$n.all,
ifelse(ARTnet.wide.adjusted$M_MP12OANUM2 == 5, ARTnet.wide.adjusted$n.all,
"6+"))
# Check variable
table(ARTnet.wide.adjusted$partners_bi, ARTnet.wide.adjusted$total_part)
# Slope by new variable
ARTnet.wide.adjusted %>%
group_by(total_part) %>%
summarize(mean.slope.m = mean(main.slope),
mean.slope.c = mean(casl.slope))
# Add main.mean, casl.mean, and total.mean to ### Supplemental Table 1 ###
mean(ARTnet.wide.adjusted$main.mean)
mean(ARTnet.wide.adjusted$casl.mean)
ARTnet.wide.adjusted %>%
group_by(race.cat) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
ARTnet.wide.adjusted %>%
group_by(age.cat) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
ARTnet.wide.adjusted %>%
group_by(REGCODE) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
ARTnet.wide.adjusted %>%
group_by(HLEDUCAT_2) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
ARTnet.wide.adjusted %>%
group_by(HHINCOME_2) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
# --------------------------------------------------------------------------
# Create object ARTnet.wide.adjusted for analysis by using code found in N-month offset function
# Specify start and end months for offsets
# Note: Only single month steps are supported
start_month_offset <- 0
end_month_offset <- 12
month <- seq(start_month_offset, end_month_offset)
n_month <- paste(month, "M", sep="")
# Initalize data frames with appropriate row and column dimensions
ongoing.eval.m <- matrix(nrow = length(ARTnet.long$SUB_DATE),
ncol = end_month_offset - start_month_offset + 1)
ongoing.eval.df <- data.frame(ongoing.eval.m)
ongoing3.m <- matrix(nrow = length(ARTnet.long$SUB_DATE),
ncol = end_month_offset - start_month_offset + 1)
ongoing3.df <- data.frame(ongoing3.m)
ARTnet.long.adjusted <- ARTnet.long
ARTnet.wide.adjusted <- ARTnet.wide
mean.degree.main <- c()
mean.degree.casual <- c()
for (i in start_month_offset:end_month_offset) {
ongoing.eval <- paste("ongoing.evaluation.date.m",i,sep="")
names(ongoing.eval.df)[i - start_month_offset + 1] <- ongoing.eval
assign(ongoing.eval, ARTnet.long$SUB_DATE - round(i*30.44))
ongoing.eval.df[,i - start_month_offset + 1] <- get(ongoing.eval)
ongoing3 <- paste("ongoing3.m",i,sep="")
names(ongoing3.df)[i - start_month_offset + 1] <- ongoing3
assign(ongoing3, ifelse(is.na(ifelse(ARTnet.long.adjusted$start.date.2 <=
get(ongoing.eval) &
ARTnet.long.adjusted$end.date.2 >= get(ongoing.eval),
1, 0)), 0, ifelse(ARTnet.long.adjusted$start.date.2 <=
get(ongoing.eval) &
ARTnet.long.adjusted$end.date.2 >= get(ongoing.eval),
1, 0)))
ongoing3.df[,i - start_month_offset + 1] <- get(ongoing3)
ARTnet.long.adjusted <- cbind(ARTnet.long.adjusted,
ongoing.eval.df[i - start_month_offset + 1],
ongoing3.df[i - start_month_offset + 1])
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 1) %>%
group_by(AMIS_ID) %>%
summarise(deg.main.n.month = sum(get(paste("ongoing3.m",i,sep="")))) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
# #Additional filtering
# ARTnet.wide.adjusted <- ARTnet.wide.adjusted %>%
#   filter(age >= 16 & age <= 29) %>%
#   filter(city2 == "Chicago")
ARTnet.wide.adjusted$deg.main.n.month <- ifelse(is.na(
ARTnet.wide.adjusted$deg.main.n.month), 0,
ARTnet.wide.adjusted$deg.main.n.month)
mean.degree.main[i - start_month_offset + 1] <- mean(
ARTnet.wide.adjusted$deg.main.n.month)
deg.main.n.month.name <- paste("deg.main.n.month.m",i,sep="")
names(ARTnet.wide.adjusted)[names(ARTnet.wide.adjusted) ==
"deg.main.n.month"] <- deg.main.n.month.name
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 2) %>%
group_by(AMIS_ID) %>%
summarise(deg.casl.n.month = sum(get(paste("ongoing3.m",i,sep="")))) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted$deg.casl.n.month <- ifelse(is.na(
ARTnet.wide.adjusted$deg.casl.n.month), 0,
ARTnet.wide.adjusted$deg.casl.n.month)
mean.degree.casual[i - start_month_offset + 1] <- mean(
ARTnet.wide.adjusted$deg.casl.n.month)
deg.casl.n.month.name <- paste("deg.casl.n.month.m",i,sep="")
names(ARTnet.wide.adjusted)[names(ARTnet.wide.adjusted) ==
"deg.casl.n.month"] <- deg.casl.n.month.name
}
## Cross-tab of ongoing vs ongoing at month 0
addmargins(table(ARTnet.long.adjusted$ongoing3.m0, ARTnet.long.adjusted$ONGOING, useNA = "always"))
# Create dependent variable: slope (difference in degree for main and casual relationships between 12 and 0 months)
ARTnet.wide.adjusted <- ARTnet.wide.adjusted %>%
mutate(main.slope = deg.main.n.month.m12 - deg.main.n.month.m0,
casl.slope = deg.casl.n.month.m12 - deg.casl.n.month.m0,
main.mean = (deg.main.n.month.m0 + deg.main.n.month.m1 + deg.main.n.month.m2 +
deg.main.n.month.m3 + deg.main.n.month.m4 + deg.main.n.month.m5 +
deg.main.n.month.m6 + deg.main.n.month.m7 + deg.main.n.month.m8 +
deg.main.n.month.m9 + deg.main.n.month.m10 + deg.main.n.month.m11 + deg.main.n.month.m12)/13,
casl.mean = (deg.casl.n.month.m0 + deg.casl.n.month.m1 + deg.casl.n.month.m2 +
deg.casl.n.month.m3 + deg.casl.n.month.m4 + deg.casl.n.month.m5 +
deg.casl.n.month.m6 + deg.casl.n.month.m7 + deg.casl.n.month.m8 +
deg.casl.n.month.m9 + deg.casl.n.month.m10 + deg.casl.n.month.m11 + deg.casl.n.month.m12)/13,
total.mean = (deg.main.n.month.m0 + deg.main.n.month.m1 + deg.main.n.month.m2 +
deg.main.n.month.m3 + deg.main.n.month.m4 + deg.main.n.month.m5 +
deg.main.n.month.m6 + deg.main.n.month.m7 + deg.main.n.month.m8 +
deg.main.n.month.m9 + deg.main.n.month.m10 + deg.main.n.month.m11 +
deg.main.n.month.m12 + deg.casl.n.month.m0 + deg.casl.n.month.m1 +
deg.casl.n.month.m2 + deg.casl.n.month.m3 + deg.casl.n.month.m4 +
deg.casl.n.month.m5 + deg.casl.n.month.m6 + deg.casl.n.month.m7 +
deg.casl.n.month.m8 + deg.casl.n.month.m9 + deg.casl.n.month.m10 +
deg.casl.n.month.m11 + deg.casl.n.month.m12)/13)
# Add mean duration of relationships to ARTnet.wide.adjusted
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 1) %>%
group_by(AMIS_ID) %>%
summarise(main.avgduration = mean(duration)) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 2) %>%
group_by(AMIS_ID) %>%
summarise(casl.avgduration = mean(duration)) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
# Scale up average main and causal duration to months and years
ARTnet.wide.adjusted <- ARTnet.wide.adjusted %>%
mutate(main.avgduration.mo = main.avgduration/4,
casl.avgduration.mo = casl.avgduration/4,
main.avgduration.yr = main.avgduration/52,
casl.avgduration.yr = casl.avgduration/52)
summary(ARTnet.wide.adjusted$main.avgduration)
summary(ARTnet.wide.adjusted$casl.avgduration)
summary(ARTnet.wide.adjusted$main.avgduration.mo)
summary(ARTnet.wide.adjusted$casl.avgduration.mo)
summary(ARTnet.wide.adjusted$main.avgduration.yr)
summary(ARTnet.wide.adjusted$casl.avgduration.yr)
# Create variables for number of main, casual, and one-time partners reported
ARTnet.wide.adjusted <-
ARTnet.long.adjusted %>%
filter(ptype == 1) %>%
group_by(AMIS_ID) %>%
summarise(n.main = n()) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted <-
ARTnet.long.adjusted %>%
filter(ptype == 2) %>%
group_by(AMIS_ID) %>%
summarise(n.casl = n()) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted <-
ARTnet.long.adjusted %>%
filter(ptype == 3) %>%
group_by(AMIS_ID) %>%
summarise(n.one = n()) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
# Replace NA's with 0
ARTnet.wide.adjusted$n.main[is.na(ARTnet.wide.adjusted$n.main)] <- 0
ARTnet.wide.adjusted$n.casl[is.na(ARTnet.wide.adjusted$n.casl)] <- 0
ARTnet.wide.adjusted$n.one[is.na(ARTnet.wide.adjusted$n.one)] <- 0
# Create variable for total partners reported
ARTnet.wide.adjusted$n.all <- ARTnet.wide.adjusted$n.main + ARTnet.wide.adjusted$n.casl + ARTnet.wide.adjusted$n.one
# Check data
table(ARTnet.wide.adjusted$n.main, useNA = "always")
table(ARTnet.wide.adjusted$n.casl, useNA = "always")
table(ARTnet.wide.adjusted$n.one, useNA = "always")
table(ARTnet.wide.adjusted$n.all, useNA = "always")
# Create dichotomous variable for participants reporting 5 or fewer partners
# overall compared with participants reporting more than 5 partners in the
# past year overall
ARTnet.wide.adjusted$partners_bi <- ifelse(ARTnet.wide.adjusted$M_MP12OANUM2 > 5, 1, 0)
# Crosstab of the dichotomous
addmargins(table(ARTnet.wide.adjusted$partners_bi, ARTnet.wide.adjusted$n.all, useNA = "always"))
# Create a new dichotomous variable for participants reporting 5 or fewer partners
# regardless of they have 5 or more total partners
# 0 = 5 or fewer partners
# 1 = 6+ partners
ARTnet.wide.adjusted$partners_bi2 <-
ifelse(ARTnet.wide.adjusted$n.all < 5 & ARTnet.wide.adjusted$partners_bi == 1, 0,
ifelse(ARTnet.wide.adjusted$partners_bi == 1, 1, 0))
# Check variable
table(ARTnet.wide.adjusted$partners_bi2, ARTnet.wide.adjusted$partners_bi)
# Slope by new variable
ARTnet.wide.adjusted %>%
group_by(partners_bi2) %>%
summarize(mean.slope.m = mean(main.slope),
mean.slope.c = mean(casl.slope))
# Create a new variable for levels of reported male partners
ARTnet.wide.adjusted$total_part <-
ifelse(ARTnet.wide.adjusted$n.all < 5, ARTnet.wide.adjusted$n.all,
ifelse(ARTnet.wide.adjusted$M_MP12OANUM2 == 5, ARTnet.wide.adjusted$n.all,
"6+"))
# Check variable
table(ARTnet.wide.adjusted$partners_bi, ARTnet.wide.adjusted$total_part)
# Slope by new variable
ARTnet.wide.adjusted %>%
group_by(total_part) %>%
summarize(mean.slope.m = mean(main.slope),
mean.slope.c = mean(casl.slope))
# Add main.mean, casl.mean, and total.mean to ### Supplemental Table 1 ###
mean(ARTnet.wide.adjusted$main.mean)
mean(ARTnet.wide.adjusted$casl.mean)
ARTnet.wide.adjusted %>%
group_by(race.cat) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
ARTnet.wide.adjusted %>%
group_by(age.cat) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
ARTnet.wide.adjusted %>%
group_by(REGCODE) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
ARTnet.wide.adjusted %>%
group_by(HLEDUCAT_2) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
ARTnet.wide.adjusted %>%
group_by(HHINCOME_2) %>%
summarize(mean.main = mean(main.mean),
mean.casl = mean(casl.mean))
png('SF7.png', width=2048, height=1536, res=300)
ggplot(ARTnet.wide.adjusted, aes(x = main.avgduration.yr, y = main.slope)) +
theme_classic() +
geom_point(alpha = 0.1, size = 3) +
xlab("Mean Age of Main Relationships (Years)") +
ylab("Change in Degree of Main Relationships at 12- and 0-Month Offsets")
dev.off()
png('SF8.png', width=2048, height=1550, res=300)
ggplot(ARTnet.wide.adjusted, aes(x = casl.avgduration.yr, y = casl.slope)) +
theme_classic() +
geom_point(alpha = 0.1, size = 3) +
xlab("Mean Age of Casual Relationships (Years)") +
ylab("Change in Degree of Casual Relationships at 12- and 0-Month Offsets")
dev.off()
install.packages("EpiModel", dependencies = TRUE)
install.packages("statnetWeb")
library("EpiModel")
library("statnetWeb")
sessionInfo()
update.packages("ergm")
update.packages(ergm)
