width=.2,
position=position_dodge(0.05)) +
labs(fill= "Category", title=total_plot_title,
x = "Month Offset", y = "Mean Degree") +
ylim(c(0.5, 1.6))
total_plot <- total_plot +
geom_hline(aes(yintercept = unique(md_total_dos)),
linetype = "dotted",
data = md_df)
total_plot <- total_plot +
geom_hline(aes(yintercept = unique(md_total_dos_ll)),
linetype = "dashed",
data = md_df)
total_plot <- total_plot +
geom_hline(aes(yintercept = unique(md_total_dos_ul)),
linetype = "dashed",
data = md_df)
total_plot <- total_plot + scale_x_discrete(breaks = factor(
unique(md_df$month_num)),
labels = unique(
md_df$month))
main_plot <- ggplot(md_df,
aes(x=factor(month_num), y=md_main),
theme(axis.text.x = month)) +
geom_line() +
geom_point()+
geom_errorbar(
aes(ymin=md_main_ll, ymax=md_main_ul),
width=.2,
position=position_dodge(0.05)) +
labs(title=main_plot_title,
x = "Month Offset", y = "Mean Degree") +
theme(legend.position = "none") +
ylim(c(0.2, 0.6))
main_plot <- main_plot +
geom_hline(aes(yintercept = unique(md_main_dos)),
linetype = "dotted",
data = md_df)
main_plot <- main_plot +
geom_hline(aes(yintercept = unique(md_main_dos_ll)),
linetype = "dashed",
data = md_df)
main_plot <- main_plot +
geom_hline(aes(yintercept = unique(md_main_dos_ul)),
linetype = "dashed",
data = md_df)
main_plot <- main_plot + scale_x_discrete(breaks = factor(
unique(md_df$month_num)),
labels = unique(md_df$month))
casl_plot <- ggplot(md_df,
aes(x=factor(month_num), y=md_casl),
theme(axis.text.x = month)) +
geom_line() +
geom_point()+
geom_errorbar(
aes(ymin=md_casl_ll, ymax=md_casl_ul),
width=.2,
position=position_dodge(0.05)) +
labs(title=casl_plot_title,
x = "Month Offset", y = "Mean Degree") +
theme(legend.position = "none") +
ylim(c(0.3, 1.25))
casl_plot <- casl_plot +
geom_hline(aes(yintercept = unique(md_casl_dos)),
linetype = "dotted",
data = md_df)
casl_plot <- casl_plot +
geom_hline(aes(yintercept = unique(md_casl_dos_ll)),
linetype = "dashed",
data = md_df)
casl_plot <- casl_plot +
geom_hline(aes(yintercept = unique(md_casl_dos_ul)),
linetype = "dashed",
data = md_df)
casl_plot <- casl_plot + scale_x_discrete(breaks = factor(
unique(md_df$month_num)),
labels = unique(md_df$month))
#require(gridExtra)
suppressMessages(grid.arrange(total_plot, main_plot, casl_plot, nrow=3))
} else {
total_plot_title <- paste("Mean Degree Comparison by ",
cat," - ",
"Total Partnerships")
main_plot_title <- paste("Mean Degree Comparison by ",
cat," - ",
"Main Partnerships")
casl_plot_title <- paste("Mean Degree Comparison by ",
cat," - ",
"Casual Partnerships")
total_plot <- ggplot(md_df,
aes(x=factor(month_num), y=md_total,
group=var_val, color=var_val),
theme(axis.text.x = month)) +
geom_line() +
geom_point()+
geom_errorbar(
aes(ymin=md_total_ll, ymax=md_total_ul),
width=.2,
position=position_dodge(0.05)) +
labs(title=total_plot_title,
x = "Month Offset", y = "Mean Degree") +
scale_color_discrete(name=cat,
labels=labels) +
ylim(c(0.5, 1.6))
total_plot <- total_plot +
geom_hline(data = md_df,
aes(yintercept = md_total_dos, col = var_val),
linetype = "dashed")
main_plot <- ggplot(md_df,
aes(x=factor(month_num), y=md_main,
group=var_val, color=var_val),
theme(axis.text.x = month)) +
geom_line() +
geom_point() +
geom_errorbar(
aes(ymin=md_main_ll, ymax=md_main_ul),
width=.2,
position=position_dodge(0.05)) +
labs(title=main_plot_title,
x = "Month Offset", y = "Mean Degree") +
theme(legend.position = "none") +
ylim(c(0.2, 0.6))
main_plot <- main_plot +
geom_hline(data = md_df,
aes(yintercept = md_main_dos, col = var_val),
linetype = "dashed")
casl_plot <- ggplot(md_df,
aes(x=factor(month_num), y=md_casl,
group=var_val, color=var_val),
theme(axis.text.x = month)) +
geom_line() +
geom_point()+
geom_errorbar(
aes(ymin=md_casl_ll, ymax=md_casl_ul),
width=.2,
position=position_dodge(0.05)) +
labs(title=casl_plot_title,
x = "Month Offset", y = "Mean Degree") +
theme(legend.position = "none") +
ylim(c(0.3, 1.25))
casl_plot <- casl_plot +
geom_hline(data = md_df,
aes(yintercept = md_casl_dos, col = var_val),
linetype = "dashed")
#require(gridExtra)
#require(cowplot)
legend <- get_legend(total_plot)
total_plot <- total_plot + theme(legend.position = "none")
grid.arrange(arrangeGrob(total_plot, main_plot, casl_plot), legend, ncol=2,
widths=c(5,1))
}
}
plot_md_comparisons(all)
plot_md_comparisons(race.cat, "Race/Ethnicity",
c("Black","Hispanic", "Other", "White"))
plot_md_comparisons(age.cat, "Age Category",
c("15-24 years",
"25-34 years",
"35-44 years",
"45-54 years",
"55-65 years"))
plot_md_comparisons(region, "Census Region",
c("Northeast",
"Midwest",
"South",
"West"))
plot_md_comparisons(education, "Highest Level of Education",
c("High school or below",
"Some college",
"College and above"))
plot_md_comparisons(income, "Annual Household Income",
c("$0 to $19,999",
"$20,000 to $39,999",
"$40,000 to $74,999",
"$75,000 or more"))
# Specify start and end months for offsets
# Note: Only single month steps are supported
start_month_offset <- 0
end_month_offset <- 12
month <- seq(start_month_offset, end_month_offset)
n_month <- paste(month, "M", sep="")
# Initalize data frames with appropriate row and column dimensions
ongoing.eval.m <- matrix(nrow = length(ARTnet.long$SUB_DATE),
ncol = end_month_offset - start_month_offset + 1)
ongoing.eval.df <- data.frame(ongoing.eval.m)
ongoing3.m <- matrix(nrow = length(ARTnet.long$SUB_DATE),
ncol = end_month_offset - start_month_offset + 1)
ongoing3.df <- data.frame(ongoing3.m)
ARTnet.long.adjusted <- ARTnet.long
ARTnet.wide.adjusted <- ARTnet.wide
mean.degree.main <- c()
mean.degree.casual <- c()
for (i in start_month_offset:end_month_offset) {
ongoing.eval <- paste("ongoing.evaluation.date.m",i,sep="")
names(ongoing.eval.df)[i - start_month_offset + 1] <- ongoing.eval
assign(ongoing.eval, ARTnet.long$SUB_DATE - round(i*30.44))
ongoing.eval.df[,i - start_month_offset + 1] <- get(ongoing.eval)
ongoing3 <- paste("ongoing3.m",i,sep="")
names(ongoing3.df)[i - start_month_offset + 1] <- ongoing3
assign(ongoing3, ifelse(is.na(ifelse(ARTnet.long.adjusted$start.date.2 <=
get(ongoing.eval) &
ARTnet.long.adjusted$end.date.2 >= get(ongoing.eval),
1, 0)), 0, ifelse(ARTnet.long.adjusted$start.date.2 <=
get(ongoing.eval) &
ARTnet.long.adjusted$end.date.2 >= get(ongoing.eval),
1, 0)))
ongoing3.df[,i - start_month_offset + 1] <- get(ongoing3)
ARTnet.long.adjusted <- cbind(ARTnet.long.adjusted,
ongoing.eval.df[i - start_month_offset + 1],
ongoing3.df[i - start_month_offset + 1])
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 1) %>%
group_by(AMIS_ID) %>%
summarise(deg.main.n.month = sum(get(paste("ongoing3.m",i,sep="")))) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
# #Additional filtering
# ARTnet.wide.adjusted <- ARTnet.wide.adjusted %>%
#   filter(age >= 16 & age <= 29) %>%
#   filter(city2 == "Chicago")
ARTnet.wide.adjusted$deg.main.n.month <- ifelse(is.na(
ARTnet.wide.adjusted$deg.main.n.month), 0,
ARTnet.wide.adjusted$deg.main.n.month)
mean.degree.main[i - start_month_offset + 1] <- mean(
ARTnet.wide.adjusted$deg.main.n.month)
deg.main.n.month.name <- paste("deg.main.n.month.m",i,sep="")
names(ARTnet.wide.adjusted)[names(ARTnet.wide.adjusted) ==
"deg.main.n.month"] <- deg.main.n.month.name
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 2) %>%
group_by(AMIS_ID) %>%
summarise(deg.casl.n.month = sum(get(paste("ongoing3.m",i,sep="")))) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted$deg.casl.n.month <- ifelse(is.na(
ARTnet.wide.adjusted$deg.casl.n.month), 0,
ARTnet.wide.adjusted$deg.casl.n.month)
mean.degree.casual[i - start_month_offset + 1] <- mean(
ARTnet.wide.adjusted$deg.casl.n.month)
deg.casl.n.month.name <- paste("deg.casl.n.month.m",i,sep="")
names(ARTnet.wide.adjusted)[names(ARTnet.wide.adjusted) ==
"deg.casl.n.month"] <- deg.casl.n.month.name
}
ARTnet.wide.adjusted <- ARTnet.wide.adjusted %>%
mutate(main.slope = deg.main.n.month.m12 - deg.main.n.month.m0,
casl.slope = deg.casl.n.month.m12 - deg.casl.n.month.m0)
main.fit.race <- lm(main.slope ~ race.cat, data = ARTnet.wide.adjusted)
main.fit.age <- lm(main.slope ~ age.cat, data = ARTnet.wide.adjusted)
main.fit.income <- lm(main.slope ~ as.factor(HHINCOME_2), data = ARTnet.wide.adjusted)
main.fit.edu <- lm(main.slope ~ as.factor(HLEDUCAT_2), data = ARTnet.wide.adjusted)
main.fit.reg <- lm(main.slope ~ REGCODE, data = ARTnet.wide.adjusted)
casl.fit.race <- lm(casl.slope ~ race.cat, data = ARTnet.wide.adjusted)
casl.fit.age <- lm(casl.slope ~ age.cat, data = ARTnet.wide.adjusted)
casl.fit.income <- lm(casl.slope ~ as.factor(HHINCOME_2), data = ARTnet.wide.adjusted)
casl.fit.edu <- lm(casl.slope ~ as.factor(HLEDUCAT_2), data = ARTnet.wide.adjusted)
casl.fit.reg <- lm(casl.slope ~ REGCODE, data = ARTnet.wide.adjusted)
summary(ARTnet.wide.adjusted$main.slope)
summary(ARTnet.wide.adjusted$casl.slope)
# Add mean duration of relationships to ARTnet.wide.adjusted
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 1) %>%
group_by(AMIS_ID) %>%
summarise(main.avgduration = mean(duration)) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted <- ARTnet.long.adjusted %>%
filter(RAI == 1 | IAI == 1 | ROI == 1 | IOI == 1) %>%
filter(ptype == 2) %>%
group_by(AMIS_ID) %>%
summarise(casl.avgduration = mean(duration)) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
plot(ARTnet.wide.adjusted$main.avgduration, ARTnet.wide.adjusted$main.slope)
plot(ARTnet.wide.adjusted$casl.avgduration, ARTnet.wide.adjusted$casl.slope)
race.duration <- ARTnet.wide.adjusted %>%
group_by(race.cat) %>%
summarise(main.duration = mean(main.avgduration, na.rm = T))
ARTnet.long.adjusted %>%
filter(ptype == 1) %>%
group_by(race.cat) %>%
summarise(main.duration = mean(duration, na.rm = T))
ARTnet.long.adjusted %>%
filter(ptype == 2) %>%
group_by(race.cat) %>%
summarise(casl.duration = mean(duration, na.rm = T))
ARTnet.wide.adjusted %>%
group_by(race.cat) %>%
summarise(main.slope = mean(main.slope, na.rm = T),
casl.slope = mean(casl.slope, na.rm = T))
# Create Variable 'Age.Cat' to Create Age Categories for Ages
ARTnet.long.adjusted$age.cat <- ifelse(ARTnet.long.adjusted$age >= 15 & ARTnet.long.adjusted$age <= 24, '15-24',
ifelse(ARTnet.long.adjusted$age >= 25 & ARTnet.long.adjusted$age <= 34, '25-34',
ifelse(ARTnet.long.adjusted$age >= 35 & ARTnet.long.adjusted$age <= 44, '35-44',
ifelse(ARTnet.long.adjusted$age >= 45 & ARTnet.long.adjusted$age <= 54, '45-54',
ifelse(ARTnet.long.adjusted$age >= 55 & ARTnet.long.adjusted$age <= 65, '55-65',
ifelse(ARTnet.long.adjusted$age >= 66, '66+', 'unknown'))))))
ARTnet.long.adjusted %>%
filter(ptype == 1) %>%
group_by(age.cat) %>%
summarise(main.duration = mean(duration, na.rm = T))
ARTnet.long.adjusted %>%
filter(ptype == 2) %>%
group_by(age.cat) %>%
summarise(casl.duration = mean(duration, na.rm = T))
ARTnet.wide.adjusted %>%
group_by(age.cat) %>%
summarise(main.slope = mean(main.slope, na.rm = T),
casl.slope = mean(casl.slope, na.rm = T))
ARTnet.wide.adjusted %>%
group_by(HLEDUCAT_2) %>%
summarise(main.duration = mean(main.avgduration, na.rm = T),
casl.duration = mean(casl.avgduration, na.rm = T),
main.slope = mean(main.slope, na.rm = T),
casl.slope = mean(casl.slope, na.rm = T))
ARTnet.wide.adjusted %>%
group_by(HHINCOME_2) %>%
summarise(main.duration = mean(main.avgduration, na.rm = T),
casl.duration = mean(casl.avgduration, na.rm = T),
main.slope = mean(main.slope, na.rm = T),
casl.slope = mean(casl.slope, na.rm = T))
ARTnet.wide.adjusted <-
ARTnet.long.adjusted %>%
filter(ptype == 1) %>%
group_by(AMIS_ID) %>%
summarise(n.main = n()) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted <-
ARTnet.long.adjusted %>%
filter(ptype == 2) %>%
group_by(AMIS_ID) %>%
summarise(n.casl = n()) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
ARTnet.wide.adjusted <-
ARTnet.long.adjusted %>%
filter(ptype == 3) %>%
group_by(AMIS_ID) %>%
summarise(n.one = n()) %>%
right_join(ARTnet.wide.adjusted, by = "AMIS_ID")
addmargins(table(ARTnet.wide.adjusted$n.main))
addmargins(table(ARTnet.wide.adjusted$n.main, useNA = T))
addmargins(table(ARTnet.wide.adjusted$n.main, useNA = TRUE))
addmargins(table(ARTnet.wide.adjusted$n.main, useNA = "true"))
addmargins(table(ARTnet.wide.adjusted$n.main, useNA = "always"))
table(ARTnet.wide.adjusted$n.main, useNA = "always")
ARTnet.wide.adjusted <-
ARTnet.wide.adjusted %>%
ifelse(is.na(n.main), 0, n.main)
ARTnet.wide.adjusted <-
ARTnet.wide.adjusted %>%
ifelse(is.na(n.main), 0, ARTnet.wide.adjusted$n.main)
ARTnet.wide.adjusted$n.main[is.na()] <- 0
ARTnet.wide.adjusted[is.na(ARTnet.wide.adjusted$n.main)] <- 0
ARTnet.wide.adjusted$n.main[is.na(ARTnet.wide.adjusted$n.main)] <- 0
table(ARTnet.wide.adjusted$n.main, useNA = "always")
ARTnet.wide.adjusted$n.casl[is.na(ARTnet.wide.adjusted$n.casl)] <- 0
ARTnet.wide.adjusted$n.all[is.na(ARTnet.wide.adjusted$n.all)] <- 0
table(ARTnet.wide.adjusted$n.casl, useNA = "always")
table(ARTnet.wide.adjusted$n.one, useNA = "always")
table(ARTnet.wide.adjusted$n.all, useNA = "always")
#create total partners variable
ARTnet.wide.adjusted$n.all <- ARTnet.wide.adjusted$n.main + ARTnet.wide.adjusted$n.casl + ARTnet.wide.adjusted$n.one
table(ARTnet.wide.adjusted$n.all, useNA = "always")
print(ARTnet.wide.adjusted$n.all, obs=100)
test <- ARTnet.wide.adjusted %>%
select(n.main, n.casl, n.one, n.all)
View(test)
ARTnet.wide.adjusted$n.one[is.na(ARTnet.wide.adjusted$n.one)] <- 0
#create total partners variable
ARTnet.wide.adjusted$n.all <- ARTnet.wide.adjusted$n.main + ARTnet.wide.adjusted$n.casl + ARTnet.wide.adjusted$n.one
test <- ARTnet.wide.adjusted %>%
select(n.main, n.casl, n.one, n.all)
View(test)
table(ARTnet.wide.adjusted$n.one, useNA = "always")
table(ARTnet.wide.adjusted$n.all, useNA = "always")
rm(test)
# scale up average main and causal duration to months
ARTnet.wide.adjusted <- ARTnet.wide.adjusted %>%
mutate(main.avgduration.mo = main.avgduration/4,
casl.avgduration.mo = casl.avgduration/4)
main.multiple <- lm(main.slope ~ race.cat + age + main.avgduration.mo + n.all, data = ARTnet.wide.adjusted)
summary(main.multiple)
round(confint(main.multiple), 3)
ARTnet.wide.adjusted <- ARTnet.wide.adjusted %>%
mutate(main.avgduration.yr = main.avgduration/52,
casl.avgduration.yr = casl.avgduration/52)
main.multiple.yr <- lm(main.slope ~ race.cat + age + main.avgduration.yr + n.all, data = ARTnet.wide.adjusted)
summary(main.multiple.yr)
round(confint(.yr), 3)
round(confint(main.multiple.yr), 3)
casl.multiple <- lm(casl.slope ~ race.cat + age + casl.avgduration.mo + n.all, data = ARTnet.wide.adjusted)
summary(casl.multiple)
round(confint(casl.multiple), 3)
casl.multiple.yr <- lm(casl.slope ~ race.cat + age + casl.avgduration.yr + n.all, data = ARTnet.wide.adjusted)
summary(casl.multiple.yr)
round(confint(casl.multiple.yr), 3)
main.multiple.yr <- lm(main.slope ~ race.cat + age + main.avgduration.yr + n.all, data = ARTnet.wide.adjusted)
summary(main.multiple.yr)
round(confint(main.multiple.yr), 3)
casl.multiple.yr <- lm(casl.slope ~ race.cat + age + casl.avgduration.yr + n.all, data = ARTnet.wide.adjusted)
summary(casl.multiple.yr)
round(confint(casl.multiple.yr), 3)
summary(ARTnet.wide.adjusted$age)
plot(ARTnet.wide.adjusted$main.avgduration, ARTnet.wide.adjusted$n.all)
table(ARTnet.wide.adjusted$main.slope, ARTnet.wide.adjusted$n.all)
plot(ARTnet.wide.adjusted$main.slope, ARTnet.wide.adjusted$n.all)
plot(ARTnet.wide.adjusted$n.all, ARTnet.wide.adjusted$main.slope)
table(ARTnet.wide.adjusted$main.slope, ARTnet.wide.adjusted$n.all)
plot(ARTnet.wide.adjusted$n.all, ARTnet.wide.adjusted$main.slope)
plot(ARTnet.wide.adjusted$n.all, ARTnet.wide.adjusted$casl.slope)
plot(ARTnet.wide.adjusted$n.all, ARTnet.wide.adjusted$casl.slope)
#main slope outliers
ARTnet.wide.adjusted %>%
filter(!(main.slope %in% c(-1:1)))
#main slope outliers
ARTnet.wide.adjusted %>%
filter(!(main.slope %in% c(-1:1))) %>%
select(AMIS_ID)
#casual slope outliers
ARTnet.wide.adjusted %>%
filter(!(casl.slope %in% c(-3:3))) %>%
select(AMIS_ID)
#casual slope outliers
print(ARTnet.wide.adjusted %>%
filter(!(casl.slope %in% c(-3:3))) %>%
select(AMIS_ID))
#casual slope outliers
print(ARTnet.wide.adjusted %>%
filter(!(casl.slope %in% c(-3:3))) %>%
select(AMIS_ID), nobs=22)
#casual slope outliers
print(ARTnet.wide.adjusted %>%
filter(!(casl.slope %in% c(-3:3))) %>%
select(AMIS_ID), obs=22)
#main slope outliers
ARTnet.wide.adjusted %>%
filter(!(main.slope %in% c(-1:1))) %>%
select(AMIS_ID)
#main slope outliers
ARTnet.wide.adjusted %>%
filter(!(main.slope %in% c(-1:1))) %>%
select(AMIS_ID, main.slope)
main.outliers <- ARTnet.long.adjusted %>%
filter(AMIS_ID == c(2515935,3017617,27010355,2976652,32510928)) %>%
select(AMIS_ID, ptype, start.date2, end.date.2)
main.outliers <- ARTnet.long.adjusted %>%
filter(AMIS_ID %in% c(2515935,3017617,27010355,2976652,32510928)) %>%
select(AMIS_ID, ptype, start.date2, end.date.2)
main.outliers <- ARTnet.long %>%
filter(AMIS_ID %in% c(2515935,3017617,27010355,2976652,32510928)) %>%
select(AMIS_ID, ptype, start.date.2, end.date.2)
View(main.outliers)
#casual slope outliers
ARTnet.wide.adjusted %>%
filter(!(casl.slope %in% c(-3:3))) %>%
select(AMIS_ID, casl.slope)
#casual slope outliers
ARTnet.wide.adjusted %>%
filter(!(casl.slope %in% c(-3:3))) %>%
select(AMIS_ID, casl.slope) %>%
print(n=22)
ARTnet.long %>%
filter(AMIS_ID %in% c(2515935,3017617,27010355,2976652,32510928)) %>%
select(AMIS_ID, ptype, start.date.2, end.date.2)
ARTnet.long %>%
filter(AMIS_ID %in% c(2515935,3017617,27010355,2976652,32510928)) %>%
select(AMIS_ID, ptype, SUB_DATE, start.date.2, end.date.2)
ARTnet.long %>%
filter(AMIS_ID %in% c(2515935,3017617,27010355,2976652,32510928)) %>%
select(AMIS_ID, ptype, SUB_DATE, start.date.2, end.date.2)
#casual slope outliers
ARTnet.wide.adjusted %>%
filter(!(casl.slope %in% c(-3:3))) %>%
select(AMIS_ID, casl.slope) %>%
print(n=22)
ARTnet.long %>%
filter(AMIS_ID %in% c(2515935,3017617,27010355,2976652,32510928)) %>%
select(AMIS_ID, ptype, SUB_DATE, start.date.2, end.date.2)
ARTnet.long %>%
filter(AMIS_ID %in% c(2568904,26610093,2853178,263264,2997173)) %>%
select(AMIS_ID, ptype, SUB_DATE, start.date.2, end.date.2) %>%
mutate(months.sub.start = (year(SUB_DATE) - year(start.date.2)) * 12 + month(SUB_DATE) - month(start.date.2),
months.sub.end = (year(SUB_DATE) - year(end.date.2)) * 12 + month(SUB_DATE) - month(end.date.2))
ARTnet.long %>%
filter(AMIS_ID %in% c(2515935,3017617,27010355,2976652,32510928)) %>%
select(AMIS_ID, ptype, SUB_DATE, start.date.2, end.date.2) %>%
mutate(months.sub.start = (year(SUB_DATE) - year(start.date.2)) * 12 + month(SUB_DATE) - month(start.date.2),
months.sub.end = (year(SUB_DATE) - year(end.date.2)) * 12 + month(SUB_DATE) - month(end.date.2))
main.outliers <- ARTnet.long %>%
filter(AMIS_ID %in% c(2515935,3017617,27010355,2976652,32510928)) %>%
select(AMIS_ID, ptype, SUB_DATE, start.date.2, end.date.2) %>%
mutate(months.sub.start = (year(SUB_DATE) - year(start.date.2)) * 12 + month(SUB_DATE) - month(start.date.2),
months.sub.end = (year(SUB_DATE) - year(end.date.2)) * 12 + month(SUB_DATE) - month(end.date.2))
View(main.outliers)
casl.outliers <- ARTnet.long %>%
filter(AMIS_ID %in% c(2568904,26610093,2853178,263264,2997173)) %>%
select(AMIS_ID, ptype, SUB_DATE, start.date.2, end.date.2) %>%
mutate(months.sub.start = (year(SUB_DATE) - year(start.date.2)) * 12 + month(SUB_DATE) - month(start.date.2),
months.sub.end = (year(SUB_DATE) - year(end.date.2)) * 12 + month(SUB_DATE) - month(end.date.2))
#main slope outliers
ARTnet.wide.adjusted %>%
filter(!(main.slope %in% c(-1:1))) %>%
select(AMIS_ID, main.slope)
#casual slope outliers
ARTnet.wide.adjusted %>%
filter(!(casl.slope %in% c(-3:3))) %>%
select(AMIS_ID, casl.slope) %>%
print(n=22)
casl.outliers <- ARTnet.long %>%
filter(AMIS_ID %in% c(2568904,26610093,2853178,263264,2997173)) %>%
select(AMIS_ID, ptype, SUB_DATE, start.date.2, end.date.2) %>%
mutate(months.sub.start = (year(SUB_DATE) - year(start.date.2)) * 12 + month(SUB_DATE) - month(start.date.2),
months.sub.end = (year(SUB_DATE) - year(end.date.2)) * 12 + month(SUB_DATE) - month(end.date.2))
View(casl.outliers)
